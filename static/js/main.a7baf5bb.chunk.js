(this["webpackJsonpsecurity-todo"]=this["webpackJsonpsecurity-todo"]||[]).push([[0],{101:function(e,t,n){"use strict";n.r(t);var r=n(0),c=n.n(r),a=n(24),s=n.n(a),i=n(27),o=n(54),l=n(45),j=n(8),u=n(26),d=n(7),b=n(110),h=n(111),O=function(e){localStorage.setItem("@app/user",JSON.stringify(e))},f=n(1),x=function(e){var t=e.isAdmin,n=Object(j.f)(),c=Object(r.useState)(0),a=Object(d.a)(c,2),s=a[0],i=a[1],o=function(e){n.push(e)};return Object(f.jsxs)(b.a,{bg:"primary",variant:"dark",children:[Object(f.jsx)(b.a.Brand,{onClick:function(){return o("/")},children:"To do"}),Object(f.jsx)(b.a.Toggle,{"aria-controls":"basic-navbar-nav"}),Object(f.jsxs)(b.a.Collapse,{id:"basic-navbar-nav",children:[Object(f.jsxs)(h.a,{className:"mr-auto",children:[Object(f.jsx)(h.a.Link,{active:0===s,onClick:function(){o("/todos"),i(0)},children:"My todos"}),t?Object(f.jsx)(h.a.Link,{active:1===s,onClick:function(){o("/users"),i(1)},children:"Users"}):Object(f.jsx)(f.Fragment,{})]}),Object(f.jsx)(h.a,{children:Object(f.jsx)(h.a.Link,{active:!0,onClick:function(){localStorage.clear(),window.location.reload()},children:"Logout"})})]})]})},p=n(31),v=n.n(p),m=n(44),y=n(103),g=n(109),C=n(104),k=n(105),w=Object(r.createContext)({});w.Consumer;function S(e){var t=Object(r.useState)(),n=Object(d.a)(t,2),c=n[0],a=n[1];return Object(r.useEffect)((function(){var e=function(){var e=localStorage.getItem("@app/user");return e?JSON.parse(e||""):{}}();a(e)}),[]),Object(f.jsx)(w.Provider,{value:{setCurrentUser:a,currentUser:c},children:e.children})}var T=n(64),U=n.n(T).a.create({baseURL:"https://security-todo-server.herokuapp.com/"});var I=function(){var e=Object(j.f)(),t=Object(r.useContext)(w).setCurrentUser,n=Object(r.useState)(""),c=Object(d.a)(n,2),a=c[0],s=c[1],i=Object(r.useState)(""),o=Object(d.a)(i,2),l=o[0],u=o[1];function b(){return(b=Object(m.a)(v.a.mark((function n(){return v.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:U.post("users/authentication",{email:a,password:l}).then((function(n){t(n.data.userPayload),O(n.data.userPayload),e.push("/todos")})).catch((function(e){return alert(e.response.data.message)}));case 1:case"end":return n.stop()}}),n)})))).apply(this,arguments)}return Object(f.jsx)(y.a,{style:{display:"flex",justifyContent:"center",alignItems:"center",width:"100vw",height:"100vh"},children:Object(f.jsxs)(g.a,{style:{width:"45%"},children:[Object(f.jsxs)(g.a.Group,{controlId:"formBasicEmail",children:[Object(f.jsx)(g.a.Label,{children:"User"}),Object(f.jsx)(g.a.Control,{type:"email",placeholder:"User",onChange:function(e){return s(e.target.value)}})]}),Object(f.jsxs)(g.a.Group,{controlId:"formBasicPassword",children:[Object(f.jsx)(g.a.Label,{children:"Password"}),Object(f.jsx)(g.a.Control,{type:"password",placeholder:"Password",onChange:function(e){return u(e.target.value)}})]}),Object(f.jsxs)(C.a,{style:{justifyContent:"space-between",padding:"1rem"},children:[Object(f.jsx)(k.a,{variant:"primary",type:"button",onClick:function(){return b.apply(this,arguments)},children:"Login"}),Object(f.jsx)(k.a,{variant:"light",type:"button",onClick:function(){e.push({pathname:"/signup"})},children:"Sign Up"})]})]})})};var E=function(){var e=Object(r.useState)(""),t=Object(d.a)(e,2),n=t[0],c=t[1],a=Object(r.useState)(""),s=Object(d.a)(a,2),i=s[0],o=s[1],l=Object(r.useState)(""),u=Object(d.a)(l,2),b=u[0],h=u[1],O=Object(r.useState)(""),x=Object(d.a)(O,2),p=x[0],C=x[1],w=Object(r.useState)(0),S=Object(d.a)(w,2),T=S[0],I=S[1],E=Object(j.f)();function L(){return(L=Object(m.a)(v.a.mark((function e(){return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:U.post("users",{email:b,password:p,firstName:n,lastName:i,role:T}).then((function(e){alert(e.data.message),E.push("/signin")})).catch((function(e){return alert(e.response.data.message)}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(f.jsx)(y.a,{style:{display:"flex",justifyContent:"center",alignItems:"center",width:"100vw",height:"100vh"},children:Object(f.jsxs)(g.a,{style:{width:"45%"},children:[Object(f.jsxs)(g.a.Group,{controlId:"formBasicEmail",children:[Object(f.jsx)(g.a.Label,{children:"First name"}),Object(f.jsx)(g.a.Control,{type:"text",placeholder:"First name",onChange:function(e){return c(e.target.value)}})]}),Object(f.jsxs)(g.a.Group,{controlId:"formBasicEmail",children:[Object(f.jsx)(g.a.Label,{children:"Last name"}),Object(f.jsx)(g.a.Control,{type:"text",placeholder:"Last name",onChange:function(e){return o(e.target.value)}})]}),Object(f.jsxs)(g.a.Group,{controlId:"formBasicEmail",children:[Object(f.jsx)(g.a.Label,{children:"User"}),Object(f.jsx)(g.a.Control,{type:"email",placeholder:"User",onChange:function(e){return h(e.target.value)}})]}),Object(f.jsxs)(g.a.Group,{controlId:"formBasicPassword",children:[Object(f.jsx)(g.a.Label,{children:"Password"}),Object(f.jsx)(g.a.Control,{type:"password",placeholder:"Password",onChange:function(e){return C(e.target.value)}})]}),Object(f.jsxs)("div",{className:"mb-3",children:[Object(f.jsx)(g.a.Check,{inline:!0,label:"Admin",name:"group1",type:"radio",defaultChecked:!0,onChange:function(e){return I(0)}}),Object(f.jsx)(g.a.Check,{inline:!0,label:"User",name:"group1",type:"radio",onChange:function(e){return I(1)}})]},"inline-radio"),Object(f.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginTop:"2rem"},children:[Object(f.jsx)(k.a,{variant:"link",type:"button",onClick:function(){return E.goBack()},children:"Voltar"}),Object(f.jsx)(k.a,{variant:"primary",type:"button",onClick:function(){return function(){return L.apply(this,arguments)}()},children:"Save"})]})]})})},L=n(112);var B=function(e){return Object(f.jsx)(L.a,{style:{width:"20rem"},children:Object(f.jsxs)(L.a.Body,{children:[Object(f.jsx)(L.a.Title,{children:e.title}),Object(f.jsx)(L.a.Text,{children:e.text}),Object(f.jsxs)(C.a,{style:{justifyContent:"space-between",alignItems:"center",paddingLeft:12,paddingRight:12},children:[Object(f.jsx)(k.a,{variant:"danger",onClick:function(t){return e.onDelete(e.id)},children:"Excluir"}),Object(f.jsx)(k.a,{variant:"success",onClick:function(t){return e.onEdit(e.id)},children:"Editar"})]})]})})},N=n(106),R=n(66),D=n(108),A=Object(r.forwardRef)((function(e,t){var n=e.isUpdating,c=e.setRefresh,a=e.refresh,s=Object(r.useState)(!1),i=Object(d.a)(s,2),o=i[0],l=i[1];Object(r.useImperativeHandle)(t,(function(){return{show:function(){return b()},close:function(){return u()},setValues:function(e,t,n){p(e),L(t),S(n)}}}));var j=Object(r.useContext)(w).currentUser,u=function(){p(""),L(""),l(!1)},b=function(){return l(!0)},h=Object(r.useState)(""),O=Object(d.a)(h,2),x=O[0],p=O[1],v=Object(r.useState)(""),m=Object(d.a)(v,2),C=m[0],S=m[1],T=Object(r.useState)(""),I=Object(d.a)(T,2),E=I[0],L=I[1],B=function(){c(!a),p(""),L(""),u()};return Object(f.jsxs)(D.a,{show:o,onHide:u,children:[Object(f.jsx)(D.a.Header,{closeButton:!0,children:Object(f.jsx)(D.a.Title,{children:n?"Atualiza\xe7\xe3o de nota":"Cadastro de nota"})}),Object(f.jsx)(D.a.Body,{children:Object(f.jsx)(y.a,{children:Object(f.jsxs)(g.a,{style:{width:"45%"},children:[Object(f.jsxs)(g.a.Group,{controlId:"formBasicEmail",children:[Object(f.jsx)(g.a.Label,{children:"T\xedtulo da Nota"}),Object(f.jsx)(g.a.Control,{value:x,type:"text",placeholder:"T\xedtulo",onChange:function(e){return p(e.target.value)}})]}),Object(f.jsxs)(g.a.Group,{controlId:"formBasicEmail",children:[Object(f.jsx)(g.a.Label,{children:"Descri\xe7\xe3o"}),Object(f.jsx)(g.a.Control,{value:E,type:"text",placeholder:"Descri\xe7\xe3o",onChange:function(e){return L(e.target.value)}})]})]})})}),Object(f.jsxs)(D.a.Footer,{children:[Object(f.jsx)(k.a,{variant:"secondary",onClick:u,children:"Fechar"}),n?Object(f.jsx)(k.a,{variant:"primary",onClick:function(){U.put("todos/".concat(C),{title:x,description:E},{headers:{authorization:null===j||void 0===j?void 0:j.accessToken}}).then((function(e){return B()})).catch((function(e){return alert(e.response.data.message)}))},children:"Atualizar"}):Object(f.jsx)(k.a,{variant:"primary",onClick:function(){U.post("todos",{title:x,description:E},{headers:{authorization:null===j||void 0===j?void 0:j.accessToken}}).then((function(e){return B()})).catch((function(e){return alert(e.response.data.message)}))},children:"Salvar"})]})]})}));var P=function(e){var t=Object(r.useRef)(),n=Object(r.useRef)();return Object(r.useContext)(w).currentUser,Object(f.jsxs)(L.a,{style:{width:"40em"},children:[Object(f.jsxs)(L.a.Header,{style:{display:"flex",justifyContent:"space-between"},children:[Object(f.jsx)("h5",{children:"My todos"}),Object(f.jsx)(k.a,{variant:"primary",onClick:function(){t.current.show()},children:"Nova Nota"})]}),e.list.length>0?Object(f.jsxs)(N.a,{variant:"flush",style:{alignItems:"center",justifyContent:"center"},children:[e.list.map((function(t){return Object(f.jsx)(R.a,{style:{width:"22rem"},children:Object(f.jsx)(B,{id:t.id,title:t.title,text:t.description,onEdit:function(){return function(e){n.current.setValues(e.title,e.description,e.id),n.current.show()}(t)},onDelete:function(){return e.onDelete(t)}})})})),Object(f.jsx)(A,{ref:n,isUpdating:!0,refresh:e.refresh,setRefresh:e.setRefresh})]}):Object(f.jsx)("div",{style:{padding:20,display:"flex",justifyContent:"center"},children:Object(f.jsx)("h3",{children:"No notes found"})}),Object(f.jsx)(A,{ref:t,setRefresh:e.setRefresh,refresh:e.refresh})]})};var z,F=function(){var e=Object(r.useState)([]),t=Object(d.a)(e,2),n=t[0],c=t[1],a=Object(r.useState)(!1),s=Object(d.a)(a,2),i=s[0],o=s[1];Object(r.useEffect)((function(){j()}),[i]);var l=Object(r.useContext)(w).currentUser,j=function(){U.get("users/todos",{headers:{authorization:null===l||void 0===l?void 0:l.accessToken}}).then((function(e){return c(e.data.todos)})).catch((function(e){return alert(e.response.data.message)}))};return Object(r.useEffect)((function(){j()}),[]),Object(f.jsx)(y.a,{style:{display:"flex",justifyContent:"center",alignItems:"center",marginTop:"1em"},children:Object(f.jsx)(P,{onDelete:function(e){U.delete("todos/".concat(e.id),{headers:{authorization:null===l||void 0===l?void 0:l.accessToken}}).then((function(e){return j()})).catch((function(e){return alert(e)}))},refresh:i,setRefresh:o,list:n})})},G=n(107),M=function(){var e=Object(j.f)(),t=Object(r.useContext)(w).currentUser,n=Object(r.useState)(),c=Object(d.a)(n,2),a=c[0],s=c[1];return Object(r.useEffect)((function(){U.get("users",{headers:{authorization:null===t||void 0===t?void 0:t.accessToken}}).then((function(e){return s(e.data.users)})).catch((function(e){return alert(e.response.data.message)}))}),[]),Object(f.jsx)(y.a,{style:{marginTop:20},children:Object(f.jsxs)(G.a,{striped:!0,bordered:!0,hover:!0,children:[Object(f.jsx)("thead",{children:Object(f.jsx)("tr",{children:Object(f.jsx)("th",{children:"Users"})})}),Object(f.jsx)("tbody",{children:null===a||void 0===a?void 0:a.map((function(n){return Object(f.jsx)("tr",{children:Object(f.jsxs)("td",{style:{display:"flex",justifyContent:"space-between",flexDirection:"row"},children:[Object(f.jsx)("p",{children:n.email}),Object(f.jsxs)("div",{style:{width:"15%",display:"flex",justifyContent:"space-between"},children:[Object(f.jsx)(k.a,{variant:"primary",onClick:function(){return function(t){e.push({pathname:"/userdetails",state:{user:t}})}(n)},children:"Ver"}),Object(f.jsx)(k.a,{variant:"danger",onClick:function(){return e=null===n||void 0===n?void 0:n.id,void U.delete("users/".concat(e),{headers:{authorization:null===t||void 0===t?void 0:t.accessToken}}).then((function(){return s(null===a||void 0===a?void 0:a.filter((function(t){return t.id!==e})))})).catch((function(e){return alert(e.response.data.message)}));var e},children:"Excluir"})]})]})},n.id)}))})]})})};!function(e){e[e.ADMIN=0]="ADMIN",e[e.USER=1]="USER"}(z||(z={}));var V=function(e){var t=e.location.state.user,n=Object(j.f)();return Object(f.jsxs)(y.a,{style:{marginTop:20},children:[Object(f.jsx)(k.a,{variant:"link",type:"button",onClick:function(){return n.goBack()},children:"Voltar"}),Object(f.jsx)(L.a,{children:Object(f.jsxs)(L.a.Body,{children:[Object(f.jsx)(L.a.Title,{children:"User details"}),Object(f.jsx)(L.a.Text,{children:Object(f.jsxs)("p",{children:["First name: ",t.firstName," ",Object(f.jsx)("br",{}),"Last name: ",t.lastName," ",Object(f.jsx)("br",{}),"Email: ",t.email," ",Object(f.jsx)("br",{}),"Role: ",z[t.role]," ",Object(f.jsx)("br",{})]})})]})})]})},H=["component"],J=["component"];function q(){var e=Object(r.useContext)(w).currentUser,t=function(t){var n=t.component,r=Object(o.a)(t,H);return Object(f.jsx)(j.b,Object(i.a)(Object(i.a)({},r),{},{render:function(t){return(null===e||void 0===e?void 0:e.accessToken)?Object(f.jsx)(n,Object(i.a)({},t)):Object(f.jsx)(j.a,{to:"/signin"})}}))},n=function(t){var n=t.component,r=Object(o.a)(t,J);return Object(f.jsx)(j.b,Object(i.a)(Object(i.a)({},r),{},{render:function(t){return(null===e||void 0===e?void 0:e.accessToken)&&(null===e||void 0===e?void 0:e.role)===z.ADMIN?Object(f.jsx)(n,Object(i.a)({},t)):Object(f.jsx)(j.a,{to:"/todos"})}}))};return Object(f.jsxs)(u.a,{children:[(null===e||void 0===e?void 0:e.accessToken)?Object(f.jsx)(x,{isAdmin:(null===e||void 0===e?void 0:e.role)===z.ADMIN}):Object(f.jsx)(f.Fragment,{}),Object(f.jsxs)(l.a,{children:[Object(f.jsx)(j.b,{exact:!0,path:"/",component:F}),!(null===e||void 0===e?void 0:e.accessToken)&&Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)(j.b,{path:"/signin",component:I}),Object(f.jsx)(j.b,{path:"/signup",component:E})]}),Object(f.jsx)(t,{path:"/todos",component:F}),Object(f.jsx)(n,{path:"/users",component:M}),Object(f.jsx)(n,{path:"/userdetails",component:V}),(null===e||void 0===e?void 0:e.accessToken)?Object(f.jsx)(j.a,{to:"/todos"}):Object(f.jsx)(j.a,{to:"/signin"})]})]})}var K=function(){return Object(f.jsx)(S,{children:Object(f.jsx)(q,{})})};n(100);s.a.render(Object(f.jsx)(c.a.StrictMode,{children:Object(f.jsx)(K,{})}),document.getElementById("root"))}},[[101,1,2]]]);
//# sourceMappingURL=main.a7baf5bb.chunk.js.map